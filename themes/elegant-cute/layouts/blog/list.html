{{ define "main" }}
<div class="blog-header">
    <h1 class="blog-title">
        <i class="fas fa-blog"></i>
        Blog Java & JavaScript
    </h1>
    <p class="blog-description">
        Kh√°m ph√° th·∫ø gi·ªõi l·∫≠p tr√¨nh m·∫°ng v·ªõi Java & JavaScript
    </p>
</div>

<div class="blog-filters">
    <!-- Desktop filter buttons -->
    <div class="filter-buttons desktop-filters">
        <button class="filter-btn active" data-filter="all" aria-label="Hi·ªÉn th·ªã t·∫•t c·∫£ b√†i vi·∫øt">T·∫•t c·∫£</button>
        <button class="filter-btn" data-filter="java" aria-label="L·ªçc b√†i vi·∫øt Java">Java</button>
        <button class="filter-btn" data-filter="javascript" aria-label="L·ªçc b√†i vi·∫øt JavaScript">JavaScript</button>
        <button class="filter-btn" data-filter="tips" aria-label="L·ªçc b√†i vi·∫øt Tips">Tips</button>
        <form class="filter-search" action="" onsubmit="return false;" style="display:inline-flex; gap:.5rem; margin-left:1rem;">
            <input type="text" id="blog-search-input" placeholder="üîç T√¨m b√†i vi·∫øt..." aria-label="T√¨m ki·∫øm b√†i vi·∫øt" style="padding:.6rem .8rem; border-radius:25px; border:1px solid var(--border-color); min-width:220px; transition: all 0.3s ease;"/>
            <button class="filter-btn" id="blog-search-btn" aria-label="T√¨m ki·∫øm" style="padding:.6rem 1rem;">T√¨m</button>
        </form>
    </div>
    
    <!-- Mobile dropdown filter -->
    <div class="mobile-filters">
        <div class="filter-dropdown">
            <button class="dropdown-toggle" id="filter-dropdown-toggle">
                <span id="selected-filter">T·∫•t c·∫£</span>
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="dropdown-menu" id="filter-dropdown-menu">
                <button class="dropdown-item active" data-filter="all">T·∫•t c·∫£</button>
                <button class="dropdown-item" data-filter="java">Java</button>
                <button class="dropdown-item" data-filter="javascript">JavaScript</button>
                <button class="dropdown-item" data-filter="tips">Tips</button>
            </div>
        </div>
        <form class="filter-search mobile-search" action="" onsubmit="return false;">
            <input type="text" id="blog-search-input-mobile" placeholder="üîç T√¨m b√†i vi·∫øt..." aria-label="T√¨m ki·∫øm b√†i vi·∫øt"/>
            <button class="filter-btn" id="blog-search-btn-mobile" aria-label="T√¨m ki·∫øm">T√¨m</button>
        </form>
    </div>
</div>

<div class="blog-posts">
    {{ range (where .Site.RegularPages "Section" "blog") }}
    <article class="blog-post-card" data-category="{{ .Params.category | default "general" }}">
        <div class="post-header">
            <div class="post-meta">
                <span class="post-date">
                    <i class="fas fa-calendar"></i>
                    {{ .Date.Format "02/01/2006" }}
                </span>
                <span class="post-category">
                    <i class="fas fa-tag"></i>
                    {{ .Params.category | default "L·∫≠p tr√¨nh" }}
                </span>
                {{ if .Params.readingTime }}
                <span class="post-reading-time">
                    <i class="fas fa-clock"></i>
                    {{ .Params.readingTime }} ph√∫t ƒë·ªçc
                </span>
                {{ end }}
            </div>
        </div>
        
        <div class="post-content">
            <h2 class="post-title">
                <a href="{{ .Permalink }}">{{ .Title }}</a>
            </h2>
            
            <p class="post-excerpt">{{ .Summary | truncate 200 }}</p>
            
            {{ if .Params.tags }}
            <div class="post-tags">
                {{ range .Params.tags }}
                <span class="tag">{{ . }}</span>
                {{ end }}
            </div>
            {{ end }}
        </div>
        
        <div class="post-footer">
            <a href="{{ .Permalink }}" class="read-more-btn">
                ƒê·ªçc b√†i vi·∫øt <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </article>
    {{ end }}
</div>

<style>
.blog-header {
    text-align: center;
    margin: 3rem 0;
    padding: 2rem;
    background: linear-gradient(135deg, rgba(107, 70, 193, 0.1) 0%, rgba(244, 114, 182, 0.1) 100%);
    border-radius: 30px;
}

.blog-title {
    font-family: 'Inter', serif;
    font-size: 3rem;
    color: var(--text);
    margin-bottom: 1rem;
}

.blog-title i {
    color: var(--primary);
    margin-right: 1rem;
}

.blog-description {
    font-size: 1.2rem;
    color: var(--text);
    opacity: 0.8;
}

.blog-filters {
    margin: 2rem 0;
    text-align: center;
}

.filter-buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.filter-btn {
    padding: 0.8rem 1.5rem;
    border: 2px solid var(--primary);
    background: transparent;
    color: var(--primary);
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
}

.filter-btn:hover,
.filter-btn.active {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
}

.blog-posts {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 b√†i m·ªói d√≤ng */
    align-items: stretch;
    gap: 2rem;
    margin: 3rem 0;
}

.blog-post-card {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 10px 30px var(--shadow);
    transition: all 0.3s ease;
    border: 1px solid var(--border-color);
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    height: 100%;
}

.blog-post-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
}

.blog-post-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px var(--shadow);
}

/* Loading animation */
.blog-post-card {
    animation: fadeInUp 0.6s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.post-header {
    margin-bottom: 1.5rem;
}

.post-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    font-size: 0.9rem;
    color: var(--text-secondary);
    opacity: 0.8;
}

.post-meta span {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.post-meta i {
    color: var(--primary);
}

.post-category {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
}

.post-content {
    margin-bottom: 1.5rem;
}

.post-title {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    line-height: 1.3;
}

.post-title a {
    color: var(--text-primary);
    text-decoration: none;
    transition: color 0.3s ease;
}

.post-title a:hover {
    color: var(--primary);
}

.post-excerpt {
    color: var(--text-secondary);
    opacity: 0.8;
    line-height: 1.6;
    margin-bottom: 1rem;
    display: -webkit-box;
    -webkit-line-clamp: 3; 
    line-clamp: 3; 
    -webkit-box-orient: vertical;
    overflow: hidden;
    min-height: 3.2em;
}

.post-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.tag {
    background: var(--bg-primary);
    color: var(--text-primary);
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.tag:hover {
    background: var(--primary);
    color: white;
}

.read-more-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.8rem 1.5rem;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    text-decoration: none;
    border-radius: 25px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.read-more-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(107, 70, 193, 0.3);
}

/* Dark Mode Styles for Blog */
[data-theme="dark"] .blog-header {
    background: linear-gradient(135deg, rgba(31, 41, 55, 0.1) 0%, rgba(55, 65, 81, 0.1) 100%);
}

[data-theme="dark"] .blog-title {
    color: var(--text-primary);
}

[data-theme="dark"] .blog-description {
    color: var(--text-secondary);
}

[data-theme="dark"] .filter-btn {
    border-color: var(--primary);
    color: var(--primary);
    background: transparent;
}

[data-theme="dark"] .filter-btn:hover,
[data-theme="dark"] .filter-btn.active {
    background: var(--primary);
    color: white;
}

[data-theme="dark"] .blog-post-card {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
    box-shadow: 0 10px 30px var(--shadow);
}

[data-theme="dark"] .blog-post-card:hover {
    box-shadow: 0 20px 40px var(--shadow);
}

[data-theme="dark"] .post-meta {
    color: var(--text-secondary);
}

[data-theme="dark"] .post-title a {
    color: var(--text-primary);
}

[data-theme="dark"] .post-title a:hover {
    color: var(--primary);
}

[data-theme="dark"] .post-excerpt {
    color: var(--text-secondary);
}

[data-theme="dark"] .tag {
    background: var(--bg-primary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

[data-theme="dark"] .tag:hover {
    background: var(--primary);
    color: white;
}

/* Mobile dropdown styles */
.mobile-filters {
    display: none;
}

.filter-dropdown {
    position: relative;
    display: inline-block;
    margin-bottom: 1rem;
}

.dropdown-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.8rem 1.5rem;
    border: 2px solid var(--primary);
    background: white;
    color: var(--primary);
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    min-width: 150px;
}

.dropdown-toggle:hover {
    background: var(--primary);
    color: white;
}

.dropdown-toggle i {
    margin-left: 0.5rem;
    transition: transform 0.3s ease;
}

.dropdown-toggle.active i {
    transform: rotate(180deg);
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 2px solid var(--primary);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    display: none;
    overflow: hidden;
}

.dropdown-menu.show {
    display: block;
}

.dropdown-item {
    display: block;
    width: 100%;
    padding: 0.8rem 1.5rem;
    border: none;
    background: transparent;
    color: var(--primary);
    text-align: left;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
}

.dropdown-item:hover {
    background: var(--primary);
    color: white;
}

.dropdown-item.active {
    background: var(--primary);
    color: white;
}

.mobile-search {
    display: flex;
    gap: 0.5rem;
    width: 100%;
}

.mobile-search input {
    flex: 1;
    padding: 0.6rem 0.8rem;
    border-radius: 25px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.mobile-search button {
    padding: 0.6rem 1rem;
    border-radius: 25px;
}

@media (max-width: 768px) {
    .blog-title {
        font-size: 2rem;
    }
    
    .desktop-filters {
        display: none;
    }
    
    .mobile-filters {
        display: block;
    }
    
    .blog-posts { 
        grid-template-columns: 1fr; 
    }
    
    .post-meta {
        flex-direction: column;
        align-items: flex-start;
    }
}

@media (min-width: 769px) {
    .desktop-filters {
        display: flex;
    }
    
    .mobile-filters {
        display: none;
    }
}

/* Search input focus effect */
#blog-search-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.1);
    transform: scale(1.02);
}

/* Tablet: 2 c·ªôt */
@media (max-width: 1024px) and (min-width: 769px) {
    .blog-posts { grid-template-columns: repeat(2, 1fr); }
}
</style>

<script>
// Filter functionality
document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const postCards = document.querySelectorAll('.blog-post-card');
    const searchInput = document.getElementById('blog-search-input');
    const searchInputMobile = document.getElementById('blog-search-input-mobile');
    
    // Mobile dropdown elements
    const dropdownToggle = document.getElementById('filter-dropdown-toggle');
    const dropdownMenu = document.getElementById('filter-dropdown-menu');
    const selectedFilter = document.getElementById('selected-filter');
    const dropdownItems = document.querySelectorAll('.dropdown-item');

    // H√†m l·ªçc b√†i vi·∫øt theo category
    function filterByCategory(card, filter) {
        
        if (filter === 'all') return true;
        
        // L·∫•y category c·ªßa b√†i vi·∫øt t·ª´ data-category attribute
        const category = card.getAttribute('data-category') || '';
        const categoryLower = category.toLowerCase();
        
        // Logic l·ªçc theo y√™u c·∫ßu
        if (filter === "java") {
            return categoryLower === 'java';
        }
        
        if (filter === "javascript") {
            return categoryLower === 'javascript';
        }
        
        if (filter === "tips") {
            return categoryLower === 'tips';
        }
        
        return false;
    }

    // Desktop filter buttons
    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            applyFilter(this.getAttribute('data-filter'), this);
        });
        
        // Keyboard navigation support
        button.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                applyFilter(this.getAttribute('data-filter'), this);
            }
        });
    });
    
    // Mobile dropdown functionality
    if (dropdownToggle && dropdownMenu) {
        dropdownToggle.addEventListener('click', function() {
            dropdownMenu.classList.toggle('show');
            dropdownToggle.classList.toggle('active');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!dropdownToggle.contains(e.target) && !dropdownMenu.contains(e.target)) {
                dropdownMenu.classList.remove('show');
                dropdownToggle.classList.remove('active');
            }
        });
        
        // Dropdown item clicks
        dropdownItems.forEach(item => {
            item.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');
                const text = this.textContent;
                
                // Update selected text
                selectedFilter.textContent = text;
                
                // Update active states
                dropdownItems.forEach(dropdownItem => dropdownItem.classList.remove('active'));
                this.classList.add('active');
                
                // Apply filter
                applyFilter(filter, this);
                
                // Close dropdown
                dropdownMenu.classList.remove('show');
                dropdownToggle.classList.remove('active');
            });
        });
    }
    
    function applyFilter(filter, activeButton) {
        // C·∫≠p nh·∫≠t button active
        filterButtons.forEach(btn => btn.classList.remove('active'));
        activeButton.classList.add('active');

        // L·ªçc b√†i vi·∫øt s·ª≠ d·ª•ng h√†m ƒë∆°n gi·∫£n
        postCards.forEach(card => {
            if (filterByCategory(card, filter)) {
                card.style.display = 'flex';
                card.style.animation = 'fadeIn 0.5s ease-in-out';
            } else {
                card.style.display = 'none';
            }
        });
    }

    function applySearch(){
        const q = (searchInput?.value || searchInputMobile?.value || '').trim().toLowerCase();
        postCards.forEach(card => {
            const title = card.querySelector('.post-title')?.innerText.toLowerCase() || '';
            const excerpt = card.querySelector('.post-excerpt')?.innerText.toLowerCase() || '';
            const match = !q || title.includes(q) || excerpt.includes(q);
            card.style.display = match ? 'block' : 'none';
        });
    }
    
    // Desktop search
    if (searchInput){
        searchInput.addEventListener('input', applySearch);
        document.getElementById('blog-search-btn').addEventListener('click', applySearch);
        const urlQ = new URLSearchParams(window.location.search).get('q');
        if (urlQ){ searchInput.value = urlQ; applySearch(); }
    }
    
    // Mobile search
    if (searchInputMobile){
        searchInputMobile.addEventListener('input', applySearch);
        document.getElementById('blog-search-btn-mobile').addEventListener('click', applySearch);
        const urlQ = new URLSearchParams(window.location.search).get('q');
        if (urlQ){ 
            searchInputMobile.value = urlQ; 
            if (searchInput) searchInput.value = urlQ;
            applySearch(); 
        }
    }
});

// Th√™m animation fadeIn
const style = document.createElement('style');
style.textContent = `
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
`;
document.head.appendChild(style);
</script>
{{ end }}
