{{ define "main" }}
{{ if or (eq .Section "about") (eq .Title "Giới thiệu") }}
<!-- About Page Layout -->
<div class="about-container">
    <div class="about-sidebar">
        <div class="profile-section">
            <div class="profile-image">
                <img src="/images/avatar.png" alt="Trần Gia Bảo" />
            </div>
            <h1 class="profile-name">Trần Gia Bảo</h1>
        </div>
        
        <div class="contact-info">
            <h3>Thông tin cá nhân</h3>
            <div class="contact-item">
                <i class="fas fa-phone"></i>
                <span>0359222640</span>
            </div>
            <div class="contact-item">
                <i class="fas fa-envelope"></i>
                <span>tgbao.16102004@gmail.com</span>
            </div>
            <div class="contact-item">
                <i class="fab fa-github"></i>
                <a href="https://github.com/TG-Bao" target="_blank">github.com/TG-Bao</a>
            </div>
            <div class="contact-item">
                <i class="fas fa-map-marker-alt"></i>
                <span>Thủ Đức, TP.HCM</span>
            </div>
        </div>
        
        <div class="skills-section">
            <h3>Kỹ năng</h3>
            <div class="skill-category">
                <h4>Kỹ năng công nghệ</h4>
                <div class="skill-tags">
                    <span class="skill-tag">HTML</span>
                    <span class="skill-tag">CSS</span>
                    <span class="skill-tag">JavaScript</span>
                    <span class="skill-tag">ReactJS</span>
                    <span class="skill-tag">Angular</span>
                    <span class="skill-tag">Next.js</span>
                    <span class="skill-tag">PHP</span>
                    <span class="skill-tag">ASP.NET Core</span>
                    <span class="skill-tag">Java</span>
                    <span class="skill-tag">Node.js</span>
                </div>
            </div>
            <div class="skill-category">
                <h4>Cơ sở dữ liệu</h4>
                <div class="skill-tags">
                    <span class="skill-tag">SQL Server</span>
                    <span class="skill-tag">MySQL</span>
                    <span class="skill-tag">Supabase</span>
                </div>
            </div>
            <div class="skill-category">
                <h4>DevOps & Quản lý mã nguồn</h4>
                <div class="skill-tags">
                    <span class="skill-tag">Docker</span>
                    <span class="skill-tag">Git</span>
                </div>
            </div>
            <div class="skill-category">
                <h4>Làm việc nhóm</h4>
                <div class="skill-tags">
                    <span class="skill-tag">Trello</span>
                    <span class="skill-tag">Notion</span>
                </div>
            </div>
            <div class="skill-category">
                <h4>Khác</h4>
                <div class="skill-tags">
                    <span class="skill-tag">Scratch</span>
                    <span class="skill-tag">CodeKitten</span>
                    <span class="skill-tag">WordPress</span>
                    <span class="skill-tag">n8n AI agent</span>
                </div>
            </div>
            <div class="skill-category">
                <h4>Kỹ năng mềm</h4>
                <ul>
                    <li>Kinh nghiệm sử dụng, tự học và làm việc với AI</li>
                    <li>Tiếng anh giao tiếp</li>
                    <li>Kỹ năng tự học</li>
                </ul>
            </div>
        </div>
        
        <div class="hobbies-section">
            <h3>Sở thích</h3>
            <div class="hobby-tags">
                <span class="hobby-tag">Đá bóng</span>
                <span class="hobby-tag">Cầu lông</span>
                <span class="hobby-tag">Du lịch</span>
                <span class="hobby-tag">Gym</span>
            </div>
        </div>
    </div>
    
    <div class="about-main">
        <div class="career-objective">
            <h2>Mục tiêu nghề nghiệp</h2>
            <p>Là sinh viên năm 4 ngành Công nghệ thông tin. Mong muốn làm việc trong môi trường chuyên nghiệp, chủ động học hỏi và phát triển kỹ năng. Mục tiêu trở thành lập trình viên Fullstack, sử dụng thành thạo các công nghệ hiện đại. Sẵn sàng thích nghi và đóng góp cho sự phát triển của đội nhóm.</p>
        </div>
        
        <div class="education">
            <h2>Học vấn</h2>
            <div class="education-item">
                <h3>Ngành học: Công nghệ thông tin - Chuyên ngành: Công nghệ phần mềm (2022 - 2026)</h3>
                <p><strong>Đại học:</strong> Đại học công nghệ thành phố Hồ Chí Minh</p>
                <p><strong>Điểm tích luỹ:</strong> 3.62 trên hệ 4, được sinh viên tiêu biểu ở nhiều học kỳ.</p>
            </div>
        </div>
        
        <div class="awards">
            <h2>Danh hiệu và giải thưởng</h2>
            <ul>
                <li>Top 6 cuộc thi Tư duy đổi mới sáng tạo cấp Trường - 2023</li>
                <li>Giải 3 IQ toán học cấp Khoa – 2024</li>
                <li>Giải 3 HUTECH's Net Cracking Challenge - 2024</li>
                <li>Sinh viên tiêu biểu trong các kỳ học</li>
            </ul>
        </div>
        
        <div class="projects">
            <h2>Dự án</h2>
            <div class="project-item">
                <h3>Đồ án website quản lý khảo thí (3/2025 - 5/2025)</h3>
                <p><strong>Vị trí:</strong> Leader, Fullstack Developer</p>
                <p><strong>Mô tả:</strong> Website quản lý các vấn đề thi cử (sinh viên, giám thị, lịch thi, sự cố, vi phạm, hỏi đáp tự động...).</p>
                <p><strong>Công nghệ:</strong> Html, css, js, có tích hợp ai tự train (n8n)</p>
                <p><strong>Thành tựu:</strong> Rèn luyện kỹ năng thiết kế hệ thống, xử lý dữ liệu thực tế, biết thêm về n8n ai agent.</p>
            </div>
            
            <div class="project-item">
                <h3>Dự án website quản lý logictics-Clean Architecture (C#/.NET) (5/2025 - 10/2025)</h3>
                <p><strong>Vị trí:</strong> fullstack, tester</p>
                <p><strong>Mô tả:</strong> Phát triển hệ thống quản lý chuỗi cung ứng logictics với mô hình Clean Architecture (C#/.NET).</p>
                <p><strong>Thành tựu:</strong> Trải nghiệm làm việc với đội nhóm theo scrum, tiếp xúc ngôn ngữ & Frameworks lập trình mới, kinh nghiệm làm dự án thực tế.</p>
            </div>
            
            <div class="project-item">
                <h3>Website bán thức ăn nhanh - WORDPRESS (8/2023 - 10/2023)</h3>
                <p><strong>Vị trí:</strong> Fullstack</p>
                <p><strong>Mô tả:</strong> Dự án khi tham gia cuộc thi My first Website năm 2023 cấp khoa.</p>
                <p><strong>Thành tựu:</strong> Biết nhiều plugin và các AI hữu ích.</p>
            </div>
        </div>
        
        <div class="certificates">
            <h2>Chứng chỉ</h2>
            <ul>
                <li>Kỹ năng giao tiếp & làm việc nhóm - 2025</li>
                <li>TOEIC 500+ (Listening & Reading) - 10/2024</li>
                <li>Tiếng Anh giao tiếp - 2024</li>
                <li><strong>JavaScript Essentials 1 - Cisco - 27/09/2025</strong></li>
            </ul>
        </div>
    </div>
</div>

<style>
.about-container {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 2rem;
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

.about-sidebar {
    background: linear-gradient(135deg, #374151 0%, #4B5563 100%);
    color: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.profile-section {
    text-align: center;
    margin-bottom: 2rem;
}

.profile-image img {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid white;
    margin-bottom: 1rem;
}

.profile-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0;
    color: white;
}

.contact-info, .skills-section, .hobbies-section {
    margin-bottom: 2rem;
}

.contact-info h3, .skills-section h3, .hobbies-section h3 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: #F3F4F6;
    border-bottom: 2px solid #6B46C1;
    padding-bottom: 0.5rem;
}

.contact-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
    font-size: 0.9rem;
}

.contact-item i {
    width: 20px;
    color: #6B46C1;
}

.contact-item a {
    color: white;
    text-decoration: none;
}

.contact-item a:hover {
    color: #6B46C1;
}

.skill-category {
    margin-bottom: 1.5rem;
}

.skill-category h4 {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: #E5E7EB;
}

.skill-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.skill-tag {
    background: rgba(107, 70, 193, 0.2);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    font-size: 0.8rem;
    border: 1px solid rgba(107, 70, 193, 0.3);
}

.skill-category ul {
    list-style: none;
    padding: 0;
}

.skill-category li {
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: #D1D5DB;
}

.hobby-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.hobby-tag {
    background: rgba(244, 114, 182, 0.2);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    font-size: 0.8rem;
    border: 1px solid rgba(244, 114, 182, 0.3);
}

.about-main {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}

.about-main h2 {
    color: #374151;
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    border-bottom: 3px solid #6B46C1;
    padding-bottom: 0.5rem;
}

.about-main h3 {
    color: #4B5563;
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
}

.about-main p {
    color: #6B7280;
    line-height: 1.6;
    margin-bottom: 1rem;
}

.career-objective, .education, .awards, .projects, .certificates {
    margin-bottom: 2rem;
}

.education-item, .project-item {
    background: #F9FAFB;
    padding: 1.5rem;
    border-radius: 10px;
    margin-bottom: 1.5rem;
    border-left: 4px solid #6B46C1;
}

.about-main ul {
    padding-left: 1.5rem;
}

.about-main li {
    color: #6B7280;
    margin-bottom: 0.5rem;
    line-height: 1.5;
}

.about-main strong {
    color: #374151;
    font-weight: 600;
}

/* Dark mode styles */
[data-theme="dark"] .about-sidebar {
    background: linear-gradient(135deg, #1F2937 0%, #374151 100%);
}

[data-theme="dark"] .about-main {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

[data-theme="dark"] .about-main h2 {
    color: var(--text-primary);
}

[data-theme="dark"] .about-main h3 {
    color: var(--text-primary);
}

[data-theme="dark"] .about-main p {
    color: var(--text-secondary);
}

[data-theme="dark"] .about-main li {
    color: var(--text-secondary);
}

[data-theme="dark"] .about-main strong {
    color: var(--text-primary);
}

[data-theme="dark"] .education-item, 
[data-theme="dark"] .project-item {
    background: var(--bg-primary);
    border-left-color: var(--primary);
}

/* Responsive */
@media (max-width: 768px) {
    .about-container {
        grid-template-columns: 1fr;
        gap: 1rem;
        padding: 1rem;
    }
    
    .about-sidebar {
        order: 1;
    }
    
    .about-main {
        order: 2;
    }
}
</style>

{{ else }}
<!-- Default Single Post Layout -->
 
<article class="single-post">
    
    <header class="post-header">

        <div class="post-meta">
            {{ if .Params.date }}
            <span class="post-date">
                <i class="fas fa-calendar"></i>
                {{ .Date.Format "02/01/2006" }}
            </span>
            {{ end }}
            {{ if .Params.category }}
            <span class="post-category">
                <i class="fas fa-tag"></i>
                {{ .Params.category }}
            </span>
            {{ end }}
            {{ if .Params.readingTime }}
            <span class="post-reading-time">
                <i class="fas fa-clock"></i>
                {{ .Params.readingTime }} phút đọc
            </span>
            {{ end }}
        </div>
        
        <h1 class="post-title">{{ .Title }}</h1>
        
        {{ if .Params.description }}
        <p class="post-description">{{ .Params.description }}</p>
        {{ end }}
        
        {{ if .Params.tags }}
        <div class="post-tags">
            {{ range .Params.tags }}
            <span class="tag">{{ . }}</span>
            {{ end }}
        </div>
        {{ end }}
    </header>
    
    <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol class="breadcrumb-list">
            <li><a href="{{ "/" | relURL }}">Trang chủ</a></li>
            <li><a href="{{ "/blog/" | relURL }}">Blog</a></li>
            <li aria-current="page">{{ .Title }}</li>
        </ol>
    </nav>
      
    <div class="back-to-blog-top">
        <a href="{{ "/DA_LTM/blog/" | relURL }}" class="back-btn">
            <i class="fas fa-arrow-left"></i>
            <span>Trở về</span>
        </a>
    </div>

    <div class="post-layout">
        <div class="post-main">
            <div class="post-content">
                {{ .Content }}
            </div>
        </div>
        <aside class="post-toc" aria-label="Mục lục bài viết">
            <div class="toc-card">
                <div class="toc-title"><i class="fas fa-list-ul"></i> Mục lục</div>
                <nav class="toc-content">
                    {{ .TableOfContents }}
                </nav>
            </div>
        </aside>
    </div>
    
    <!-- Comment System -->
    <div class="comments-section" data-post-key="{{ .RelPermalink }}">
        <div class="comments-header">
            <h3 class="comments-title">
                <i class="fas fa-comments"></i>
                Bình luận (<span id="commentsCount">0</span>)
            </h3>
            <button id="commentsToggleBtn" class="comments-toggle" type="button" aria-expanded="true">
                Ẩn bình luận
            </button>
        </div>
        
        <!-- Comment Form -->
        <div class="comment-form-container">
            <form id="commentForm" class="comment-form">
                <div class="form-group">
                    <label for="commentEmail">Email *</label>
                    <input type="email" id="commentEmail" name="email" required 
                           placeholder="Nhập email của bạn">
                </div>
                <div class="form-group">
                    <label for="commentText">Bình luận *</label>
                    <textarea id="commentText" name="comment" required 
                              placeholder="Viết bình luận của bạn..." rows="4"></textarea>
                </div>
                <button type="submit" class="submit-btn">
                    <i class="fas fa-paper-plane"></i>
                    Gửi bình luận
                </button>
            </form>
        </div>
        
        <!-- Comments Display -->
        <div class="comments-list" id="commentsList">
            <!-- Comments will be loaded here -->
        </div>
    </div>
    
    <!-- Back to Top Button -->
    <button id="backToTop" class="back-to-top" aria-label="Lên đầu trang" title="Lên đầu trang">
        <i class="fas fa-arrow-up" aria-hidden="true"></i>
        <span class="sr-only">Lên đầu trang</span>
    </button>
    
    <footer class="post-footer">
        <div class="post-navigation">
            {{ $blogPages := where .Site.RegularPages "Section" "blog" }}
            {{ $currentIndex := -1 }}
            {{ range $index, $page := $blogPages }}
                {{ if eq $page.Permalink $.Permalink }}
                    {{ $currentIndex = $index }}
                {{ end }}
            {{ end }}
            
            {{ if gt $currentIndex 0 }}
                {{ $prevPage := index $blogPages (sub $currentIndex 1) }}
                <a href="{{ $prevPage.Permalink }}" class="nav-link prev">
                    <i class="fas fa-arrow-left"></i>
                    {{ $prevPage.Title }}
                </a>
            {{ end }}
            
            {{ if lt $currentIndex (sub (len $blogPages) 1) }}
                {{ $nextPage := index $blogPages (add $currentIndex 1) }}
                <a href="{{ $nextPage.Permalink }}" class="nav-link next">
                    {{ $nextPage.Title }}
                    <i class="fas fa-arrow-right"></i>
                </a>
            {{ end }}
        </div>
        
        
        <div class="post-share">
            <span>Chia sẻ:</span>
            <a href="https://twitter.com/intent/tweet?text={{ .Title }}&url={{ .Permalink }}" target="_blank">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ .Permalink }}" target="_blank">
                <i class="fab fa-facebook"></i>
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ .Permalink }}" target="_blank">
                <i class="fab fa-linkedin"></i>
            </a>
        </div>
    </footer>
</article>

<style>
.single-post { --page-gutter: 36px; }
.single-post {
   
    width: calc(100vw - var(--page-gutter) * 2);
    margin-left: calc(50% - 50vw + var(--page-gutter));
    max-width: calc(100vw - var(--page-gutter) * 2);
    background: rgb(255, 255, 255);
    border-radius: 10px;
    padding: 0 1.5rem;
    box-shadow: none;
    margin-bottom: 2rem;
}

.post-header {
    margin: 0 0 1.5rem 0;
    padding: 0 0 1.5rem 0;
    border-bottom: 1px solid var(--border-color);   
}

.post-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    margin-bottom: 1.5rem;
    font-size: 0.9rem;
    color: var(--text);
    opacity: 0.7;
}

.post-meta span {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.post-meta i {
    color: var(--primary);
}

.post-category {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
}

.post-title {
    font-family: 'Playfair Display', serif;
    font-size: 2.5rem;
    color: var(--text);
    margin-bottom: 1rem;
    line-height: 1.2;
}

.post-description {
    font-size: 1.2rem;
    color: var(--text);
    opacity: 0.8;
    margin-bottom: 1.5rem;
    line-height: 1.6;
}

.post-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.tag {
    background: var(--bg);
    color: var(--text);
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
    border: 1px solid rgba(107, 70, 193, 0.2);
    transition: all 0.3s ease;
}

.tag:hover {
    background: var(--primary);
    color: white;
}

.post-content {
    font-size: 1.1rem;
    line-height: 1.8;
    color: var(--text);
}

/* Layout with TOC */
.post-layout {
    display: grid;
    grid-template-columns: minmax(0, 1.6fr) 280px;
    gap: 2rem;
}

.post-main {
    min-width: 0;
}

.post-toc {
    display: block;
}

.toc-card {
    position: sticky;
    top: 100px;
    background: var(--bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    box-shadow: 0 6px 18px var(--shadow);
    padding: 1rem 1.25rem;
}

.toc-title {
    font-weight: 700;
    margin-bottom: 0.75rem;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.toc-content { max-height: 60vh; overflow: auto; }
.toc-content ul { list-style: none; padding-left: 0.75rem; }
.toc-content li { margin: 0.25rem 0; }
.toc-content a { color: var(--text-secondary); text-decoration: none; border-left: 2px solid transparent; padding-left: 0.5rem; display: inline-block; }
.toc-content a:hover { color: var(--primary); border-left-color: var(--primary); }

.post-content h1,
.post-content h2,
.post-content h3,
.post-content h4,
.post-content h5,
.post-content h6 {
    font-family: 'Playfair Display', serif;
    color: var(--text);
    margin: 2rem 0 1rem;
}

.post-content h2 {
    font-size: 2rem;
    border-bottom: 2px solid var(--bg);
    padding-bottom: 0.5rem;
}

.post-content h3 {
    font-size: 1.5rem;
}

.post-content p {
    margin-bottom: 1.5rem;
}

.post-content ul,
.post-content ol {
    margin: 1.5rem 0;
    padding-left: 2rem;
}

.post-content li {
    margin-bottom: 0.5rem;
}

.post-content blockquote {
    border-left: 4px solid var(--primary);
    padding: 1rem 2rem;
    margin: 2rem 0;
    background: var(--bg);
    border-radius: 0 10px 10px 0;
    font-style: italic;
}

.post-content code {
    background: var(--bg);
    padding: 0.2rem 0.5rem;
    border-radius: 5px;
    font-family: 'Courier New', monospace;
    color: var(--primary);
}

.post-content pre {
    background: #1a1a1a;
    color: #f8f8f2;
    padding: 1.5rem;
    border-radius: 10px;
    overflow-x: auto;
    margin: 2rem 0;
}

.post-content pre code {
    background: none;
    color: inherit;
    padding: 0;
}

.post-content img {
    max-width: 100%;
    height: auto;
    border-radius: 10px;
    margin: 2rem 0;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

.post-content a {
    color: var(--primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: all 0.3s ease;
}

.post-content a:hover {
    border-bottom-color: var(--primary);
}

.post-footer {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 2px solid var(--bg);
}

.post-navigation {
    display: flex;
    justify-content: space-between;
    margin-bottom: 2rem;
    gap: 1rem;
}

.nav-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 1.5rem;
    background: var(--bg);
    color: var(--text);
    text-decoration: none;
    border-radius: 10px;
    transition: all 0.3s ease;
    flex: 1;
    max-width: 45%;
}

.nav-link:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
}

.nav-link.prev {
    text-align: left;
}

.nav-link.next {
    text-align: right;
    flex-direction: row-reverse;
}

.post-share {
    display: flex;
    align-items: center;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
}

.post-share span {
    font-weight: 600;
    color: var(--text);
}

.post-share a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--bg);
    color: var(--text);
    border-radius: 50%;
    text-decoration: none;
    transition: all 0.3s ease;
}

.post-share a:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-3px);
}

.breadcrumb {
    margin: 1rem 0;
    padding: 0.5rem 0;
}

.breadcrumb-list {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

.breadcrumb-list li:not(:last-child)::after {
    content: "›";
    margin-left: 0.5rem;
    color: var(--text-secondary);
}

.breadcrumb-list a {
    color: var(--primary);
    text-decoration: none;
    transition: color 0.3s ease;
}

.breadcrumb-list a:hover {
    color: var(--secondary);
    text-decoration: underline;
}

.breadcrumb-list li[aria-current="page"] {
    color: var(--text-primary);
    font-weight: 500;
}

.back-to-blog-top {
    display: flex;
    justify-content: flex-start;
    margin-top: 10px;
}

.back-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.8rem 1.5rem;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    text-decoration: none;
    border-radius: 25px;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(107, 70, 193, 0.3);
}

.back-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(107, 70, 193, 0.4);
}

.back-btn i {
    font-size: 0.9rem;
}

/* Dark Mode Styles */
[data-theme="dark"] .single-post {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

[data-theme="dark"] .post-header {
    border-bottom-color: var(--border-color);
}

[data-theme="dark"] .post-meta {
    color: var(--text-secondary);
}

[data-theme="dark"] .post-title {
    color: var(--text-primary);
}

[data-theme="dark"] .post-description {
    color: var(--text-secondary);
}

[data-theme="dark"] .tag {
    background: var(--bg-primary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

[data-theme="dark"] .tag:hover {
    background: var(--primary);
    color: white;
}

[data-theme="dark"] .post-content {
    color: var(--text-primary);
}

[data-theme="dark"] .post-content h1,
[data-theme="dark"] .post-content h2,
[data-theme="dark"] .post-content h3,
[data-theme="dark"] .post-content h4,
[data-theme="dark"] .post-content h5,
[data-theme="dark"] .post-content h6 {
    color: var(--text-primary);
}

[data-theme="dark"] .post-content h2 {
    border-bottom-color: var(--border-color);
}

[data-theme="dark"] .post-content blockquote {
    background: var(--bg-primary);
    border-left-color: var(--primary);
    color: var(--text-secondary);
}

[data-theme="dark"] .post-content code {
    background: var(--bg-primary);
    color: var(--primary);
}

[data-theme="dark"] .post-content pre {
    background: #1a1a1a;
    color: #f8f8f2;
}

[data-theme="dark"] .post-content a {
    color: var(--primary);
}

[data-theme="dark"] .post-content a:hover {
    border-bottom-color: var(--primary);
}

[data-theme="dark"] .post-footer {
    border-top-color: var(--border-color);
}

[data-theme="dark"] .nav-link {
    background: var(--bg-primary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
}

[data-theme="dark"] .nav-link:hover {
    background: var(--primary);
    color: white;
}

[data-theme="dark"] .post-share span {
    color: var(--text-primary);
}

[data-theme="dark"] .post-share a {
    background: var(--bg-primary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
}

[data-theme="dark"] .post-share a:hover {
    background: var(--primary);
    color: white;
}

[data-theme="dark"] .toc-card {
    background: var(--bg-primary);
    border-color: var(--border-color);
}

[data-theme="dark"] .toc-title {
    color: var(--text-primary);
}

[data-theme="dark"] .toc-content a {
    color: var(--text-secondary);
}

[data-theme="dark"] .toc-content a:hover {
    color: var(--primary);
    border-left-color: var(--primary);
}

/* Smooth scroll for TOC links */
.toc-content a {
    scroll-behavior: smooth;
}

[data-theme="dark"] .back-btn {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
}

[data-theme="dark"] .back-btn:hover {
    box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
}

[data-theme="dark"] .breadcrumb-list {
    color: var(--text-secondary);
}

[data-theme="dark"] .breadcrumb-list li:not(:last-child)::after {
    color: var(--text-secondary);
}

[data-theme="dark"] .breadcrumb-list a {
    color: var(--primary);
}

[data-theme="dark"] .breadcrumb-list a:hover {
    color: var(--secondary);
}

[data-theme="dark"] .breadcrumb-list li[aria-current="page"] {
    color: var(--text-primary);
}

/* Back to Top Button */
.back-to-top {
    position: fixed;
    right: auto;
    left: 20px;
    bottom: 24px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: #fff;
    box-shadow: 0 8px 24px rgba(107, 70, 193, 0.35);
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
    opacity: 1;
}

.back-to-top:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 28px rgba(107, 70, 193, 0.45);
}

.back-to-top.show { opacity: 1; }

[data-theme="dark"] .back-to-top {
    box-shadow: 0 8px 24px rgba(0,0,0,0.45);
}

@media (max-width: 768px) {
    .single-post { --page-gutter: 12px; width: calc(100vw - var(--page-gutter) * 2); margin-left: calc(50% - 50vw + var(--page-gutter)); padding: 1rem; }
    .post-layout { grid-template-columns: 1fr; }
    .post-toc { order: -1; }
    
    .post-title {
        font-size: 2rem;
    }
    
    .post-meta {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .post-navigation {
        flex-direction: column;
    }
    
    .nav-link {
        max-width: 100%;
    }
    
    .back-to-blog-top {
        margin-top: 0.5rem;
        margin-bottom: 1rem;
    }
    
    .back-btn {
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
    }
}

/* Comment System Styles */
.comments-section {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 2px solid var(--border-color);
}

.comments-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 2rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.comments-title i {
    color: var(--primary);
}

.comments-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
}

.comments-toggle {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.comments-toggle:hover {
    background: var(--bg-primary);
    border-color: var(--primary);
}

.comment-form-container {
    background: var(--bg-secondary);
    padding: 2rem;
    border-radius: 15px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.comment-form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-group label {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
}

.form-group input,
.form-group textarea {
    padding: 0.8rem 1rem;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    font-size: 1rem;
    background: var(--bg-primary);
    color: var(--text-primary);
    transition: all 0.3s ease;
    font-family: inherit;
}

.form-group input:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.1);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.submit-btn {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 25px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    align-self: flex-start;
    box-shadow: 0 4px 15px rgba(107, 70, 193, 0.3);
}

.submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(107, 70, 193, 0.4);
}

.submit-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.comments-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.comments-section.collapsed .comment-form-container,
.comments-section.collapsed .comments-list {
    display: none;
}

.comment-item {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: 12px;
    border-left: 4px solid var(--primary);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.comment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.comment-author {
    font-weight: 600;
    color: var(--primary);
    font-size: 1rem;
}

.comment-date {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

.comment-content {
    color: var(--text-primary);
    line-height: 1.6;
    font-size: 1rem;
}

.comment-empty {
    text-align: center;
    padding: 3rem 2rem;
    color: var(--text-secondary);
    font-style: italic;
}

.comment-empty i {
    font-size: 3rem;
    color: var(--border-color);
    margin-bottom: 1rem;
    display: block;
}

/* Dark mode for comments */
[data-theme="dark"] .comment-form-container {
    background: var(--bg-primary);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .form-group input,
[data-theme="dark"] .form-group textarea {
    background: var(--bg-secondary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

[data-theme="dark"] .form-group input:focus,
[data-theme="dark"] .form-group textarea:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

[data-theme="dark"] .comment-item {
    background: var(--bg-primary);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .comment-author {
    color: var(--primary);
}

[data-theme="dark"] .comment-content {
    color: var(--text-primary);
}

[data-theme="dark"] .comment-empty {
    color: var(--text-secondary);
}

[data-theme="dark"] .comment-empty i {
    color: var(--border-color);
}

/* Responsive */
@media (max-width: 768px) {
    .comments-header { flex-direction: column; align-items: stretch; }
    .comments-toggle { width: 100%; }
    .comment-form-container {
        padding: 1.5rem;
    }
    
    .comment-item {
        padding: 1rem;
    }
    
    .comment-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .submit-btn {
        align-self: stretch;
    }
}
</style>

<script>
// Comment System JavaScript
class CommentSystem {
    constructor() {
        const section = document.querySelector('.comments-section');
        this.postKey = (section && section.getAttribute('data-post-key')) || window.location.pathname;
        this.comments = this.loadComments();
        this.init();
    }

    init() {
        this.renderComments();
        this.setupForm();
    }

    loadComments() {
        const stored = localStorage.getItem(`comments_${this.postKey}`);
        return stored ? JSON.parse(stored) : [];
    }

    saveComments() {
        localStorage.setItem(`comments_${this.postKey}`, JSON.stringify(this.comments));
    }

    setupForm() {
        const form = document.getElementById('commentForm');
        if (!form) return;

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.submitComment();
        });
    }

    submitComment() {
        const email = document.getElementById('commentEmail').value.trim();
        const comment = document.getElementById('commentText').value.trim();
        const submitBtn = document.querySelector('.submit-btn');

        if (!email || !comment) {
            alert('Vui lòng điền đầy đủ thông tin!');
            return;
        }

        if (!this.isValidEmail(email)) {
            alert('Email không hợp lệ!');
            return;
        }

        // Show loading state
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Đang gửi...';

        // Simulate API call delay
        setTimeout(() => {
            const newComment = {
                id: Date.now(),
                email: email,
                comment: comment,
                date: new Date().toISOString(),
                timestamp: Date.now()
            };

            this.comments.unshift(newComment);
            this.saveComments();
            this.renderComments();
            this.resetForm();

            // Reset button
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Gửi bình luận';

            // Show success message
            this.showMessage('Bình luận đã được gửi thành công!', 'success');
        }, 1000);
    }

    resetForm() {
        document.getElementById('commentForm').reset();
    }

    renderComments() {
        const container = document.getElementById('commentsList');
        const countEl = document.getElementById('commentsCount');
        if (!container) return;

        if (this.comments.length === 0) {
            container.innerHTML = `
                <div class="comment-empty">
                    <i class="fas fa-comment-slash"></i>
                    <p>Chưa có bình luận nào. Hãy là người đầu tiên bình luận!</p>
                </div>
            `;
            if (countEl) countEl.textContent = '0';
            return;
        }

        container.innerHTML = this.comments.map(comment => `
            <div class="comment-item">
                <div class="comment-header">
                    <span class="comment-author">${this.maskEmail(comment.email)}</span>
                    <span class="comment-date">${this.formatDate(comment.date)}</span>
                </div>
                <div class="comment-content">${this.escapeHtml(comment.comment)}</div>
            </div>
        `).join('');

        if (countEl) countEl.textContent = String(this.comments.length);
    }

    maskEmail(email) {
        const [username, domain] = email.split('@');
        const maskedUsername = username.length > 2 
            ? username.substring(0, 2) + '*'.repeat(username.length - 2)
            : username;
        return `${maskedUsername}@${domain}`;
    }

    formatDate(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diff = now - date;

        if (diff < 60000) return 'Vừa xong';
        if (diff < 3600000) return `${Math.floor(diff / 60000)} phút trước`;
        if (diff < 86400000) return `${Math.floor(diff / 3600000)} giờ trước`;
        if (diff < 604800000) return `${Math.floor(diff / 86400000)} ngày trước`;
        
        return date.toLocaleDateString('vi-VN');
    }

    escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }

    showMessage(message, type = 'info') {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message message-${type}`;
        messageDiv.textContent = message;
        messageDiv.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: ${type === 'success' ? '#10b981' : '#ef4444'};
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        `;

        document.body.appendChild(messageDiv);

        setTimeout(() => {
            messageDiv.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => {
                document.body.removeChild(messageDiv);
            }, 300);
        }, 3000);
    }
}

// Initialize comment system when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    new CommentSystem();
    initBackToTop();
    initCommentsToggle();
});

// Add CSS animations
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
    }
`;
document.head.appendChild(style);

// Back to Top logic
function initBackToTop() {
    const btn = document.getElementById('backToTop');
    if (!btn) return;

    const toggle = () => {
        // Luôn hiện nút
        btn.classList.add('show');
        btn.setAttribute('aria-hidden', 'false');
    };

    window.addEventListener('scroll', toggle, { passive: true });
    toggle();

    btn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
}

// Toggle ẩn/hiện bình luận và lưu trạng thái theo bài viết
function initCommentsToggle() {
    const section = document.querySelector('.comments-section');
    const btn = document.getElementById('commentsToggleBtn');
    if (!section || !btn) return;

    const postKey = section.getAttribute('data-post-key') || window.location.pathname;
    const storageKey = `comments_visibility_${postKey}`;

    // Load state
    const persisted = localStorage.getItem(storageKey);
    const isCollapsed = persisted === 'collapsed';
    if (isCollapsed) {
        section.classList.add('collapsed');
        btn.textContent = 'Mở bình luận';
        btn.setAttribute('aria-expanded', 'false');
    } else {
        btn.setAttribute('aria-expanded', 'true');
    }

    btn.addEventListener('click', () => {
        const nowCollapsed = section.classList.toggle('collapsed');
        if (nowCollapsed) {
            btn.textContent = 'Mở bình luận';
            btn.setAttribute('aria-expanded', 'false');
            localStorage.setItem(storageKey, 'collapsed');
        } else {
            btn.textContent = 'Ẩn bình luận';
            btn.setAttribute('aria-expanded', 'true');
            localStorage.setItem(storageKey, 'expanded');
        }
    });
}
</script>
{{ end }}
{{ end }}
